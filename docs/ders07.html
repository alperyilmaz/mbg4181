<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.29">

  <meta name="author" content="Alper Yılmaz">
  <meta name="dcterms.date" content="2025-05-02">
  <title>MBG4181 Biyolojik Veri Analizi ve Görüntüleme – Tidy graph analysis with {tidygraph}</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-f563837468303362081e247dddd440d0.css">
  <link rel="stylesheet" href="custom.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Tidy graph analysis with {tidygraph}</h1>
  <p class="subtitle">MBG4181 Biyolojik Veri Analizi ve Görüntüleme - Ders7</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Alper Yılmaz 
</div>
</div>
</div>

  <p class="date">2025-05-02</p>
</section>
<section class="slide level2">

<p>Contents are modified from <a href="https://github.com/intro-to-data-science-21-workshop">I2DS Tools for Data Science workshop</a> by Ania Matysiak and Johanna Mehler</p>
</section>
<section id="network-analysis" class="slide level2">
<h2>Network analysis</h2>
<ul>
<li>“Connected data” is pretty common: Social network, biological networks</li>
<li>Tackled with “graph theory” algoritms</li>
</ul>
</section>
<section id="basic-concepts-of-networks" class="slide level2">
<h2>Basic concepts of networks</h2>

<img data-src="images/basics.jpg" class="r-stretch"></section>
<section id="nodes-and-edges" class="slide level2">
<h2>Nodes and edges</h2>

<img data-src="images/nodes.gif" class="r-stretch"></section>
<section id="nodes-and-edges-1" class="slide level2">
<h2>Nodes and edges</h2>

<img data-src="images/edges.jpg" class="r-stretch"></section>
<section id="graph-or-network" class="slide level2">
<h2>Graph or Network</h2>

<img data-src="images/graph_network.jpg" class="r-stretch"></section>
<section id="types-of-networks" class="slide level2">
<h2>Types of networks</h2>

<img data-src="images/image-20230525124113107.png" class="r-stretch"><div class="footer">
<p>source: <a href="https://www.ebi.ac.uk/training/online/courses/network-analysis-of-protein-interaction-data-an-introduction/introduction-to-graph-theory/graph-theory-graph-types-and-edge-properties/">EMBL-EBI Training | Network analysis of protein interaction data</a></p>
</div>
</section>
<section id="adjacency-matrices" class="slide level2">
<h2>Adjacency Matrices</h2>

<img data-src="images/image-20230525124328050.png" class="r-stretch"><div class="footer">
<p>source: <a href="https://www.ebi.ac.uk/training/online/courses/network-analysis-of-protein-interaction-data-an-introduction/introduction-to-graph-theory/graph-theory-graph-types-and-edge-properties/">EMBL-EBI Training | Network analysis of protein interaction data</a></p>
</div>
</section>
<section id="network-topology" class="slide level2">
<h2>Network Topology</h2>
<p>Topology is the way in which the nodes and edges are arranged within a network</p>

<img data-src="images/image-20230525124501455.png" class="r-stretch"></section>
<section class="slide level2">


<img data-src="images/image-20230525124519826.png" class="r-stretch"></section>
<section class="slide level2">


<img data-src="images/image-20230525124539194.png" class="r-stretch"></section>
<section class="slide level2">


<img data-src="images/image-20230525124559582.png" class="r-stretch"></section>
<section class="slide level2">


<img data-src="images/image-20230525124618859.png" class="r-stretch"><div class="footer">
<p>source: <a href="https://www.ebi.ac.uk/training/online/courses/network-analysis-of-protein-interaction-data-an-introduction/introduction-to-graph-theory/graph-theory-graph-types-and-edge-properties/">EMBL-EBI Training | Network analysis of protein interaction data</a></p>
</div>
</section>
<section id="biological-networks" class="slide level2">
<h2>Biological networks</h2>

<img data-src="images/image-20230525124745082.png" class="r-stretch"><div class="footer">
<p>source: <a href="https://www.ebi.ac.uk/training/online/courses/network-analysis-of-protein-interaction-data-an-introduction/introduction-to-graph-theory/graph-theory-graph-types-and-edge-properties/">EMBL-EBI Training | Network analysis of protein interaction data</a></p>
</div>
</section>
<section id="ppi" class="slide level2">
<h2>PPI</h2>

<img data-src="images/image-20230525124831773.png" class="r-stretch"></section>
<section id="tidy-approach-for-network-data" class="slide level2">
<h2>Tidy approach for network data</h2>
<p>How can we represent network data in a tidy way?</p>
<p>{tidygraph} package keeps nodes and edges data as two separate tibble data. Both of which can be manipulated, processed with {dplyr} verbs.</p>
</section>
<section id="graphs-a-tidy-approach" class="slide level2">
<h2>Graphs, a tidy approach</h2>

<img data-src="images/tbl_graph.png" class="r-stretch"><div class="footer">
<p><a href="https://bookdown.org/wangminjie/R4DS/eda-tidygraph.html">source</a></p>
</div>
</section>
<section id="sample-network" class="slide level2">
<h2>Sample network</h2>
<p>simple friend or following network</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a></a><span class="fu">library</span>(tidygraph)</span>
<span id="cb1-3"><a></a></span>
<span id="cb1-4"><a></a>friends <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">person1 =</span> <span class="fu">c</span>(<span class="st">"alice"</span>, <span class="st">"charles"</span>, <span class="st">"david"</span>, <span class="st">"bob"</span>, <span class="st">"fiona"</span>, <span class="st">"gary"</span>, <span class="st">"bob"</span>, <span class="st">"alice"</span>, <span class="st">"david"</span>), </span>
<span id="cb1-5"><a></a>                  <span class="at">person2 =</span> <span class="fu">c</span>(<span class="st">"bob"</span>, <span class="st">"bob"</span>, <span class="st">"bob"</span>, <span class="st">"allen"</span>, <span class="st">"bob"</span>, <span class="st">"bob"</span>, <span class="st">"henry"</span>, <span class="st">"allen"</span>, <span class="st">"fiona"</span>))</span>
<span id="cb1-6"><a></a></span>
<span id="cb1-7"><a></a>friends</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
  person1 person2
  &lt;chr&gt;   &lt;chr&gt;  
1 alice   bob    
2 charles bob    
3 david   bob    
4 bob     allen  
5 fiona   bob    
6 gary    bob    
7 bob     henry  
8 alice   allen  
9 david   fiona  </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>let’s convert this dataframe to a graph/network</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>friends_g <span class="ot">&lt;-</span> friends <span class="sc">|&gt;</span> <span class="fu">as_tbl_graph</span>()</span>
<span id="cb3-2"><a></a></span>
<span id="cb3-3"><a></a>friends_g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 8 nodes and 9 edges
#
# A directed acyclic simple graph with 1 component
#
# Node Data: 8 × 1 (active)
  name   
  &lt;chr&gt;  
1 alice  
2 charles
3 david  
4 bob    
5 fiona  
6 gary   
7 allen  
8 henry  
#
# Edge Data: 9 × 2
   from    to
  &lt;int&gt; &lt;int&gt;
1     1     4
2     2     4
3     3     4
# ℹ 6 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Let’s calculate degrees. Notice that “bob” is followed by 5 people, “bob” follows 2 people (total degree 7)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>friends_g <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">deg =</span> <span class="fu">centrality_degree</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 8 nodes and 9 edges
#
# A directed acyclic simple graph with 1 component
#
# Node Data: 8 × 2 (active)
  name      deg
  &lt;chr&gt;   &lt;dbl&gt;
1 alice       2
2 charles     1
3 david       2
4 bob         2
5 fiona       1
6 gary        1
7 allen       0
8 henry       0
#
# Edge Data: 9 × 2
   from    to
  &lt;int&gt; &lt;int&gt;
1     1     4
2     2     4
3     3     4
# ℹ 6 more rows</code></pre>
</div>
</div>
<p><strong>The default degree is <code>mode="out"</code></strong></p>
</section>
<section class="slide level2">

<p>Let’s get all connections (in and out)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>friends_g <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a></a>  <span class="fu">mutate</span>(<span class="at">deg =</span> <span class="fu">centrality_degree</span>(<span class="at">mode=</span><span class="st">"all"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 8 nodes and 9 edges
#
# A directed acyclic simple graph with 1 component
#
# Node Data: 8 × 2 (active)
  name      deg
  &lt;chr&gt;   &lt;dbl&gt;
1 alice       2
2 charles     1
3 david       2
4 bob         7
5 fiona       2
6 gary        1
7 allen       2
8 henry       1
#
# Edge Data: 9 × 2
   from    to
  &lt;int&gt; &lt;int&gt;
1     1     4
2     2     4
3     3     4
# ℹ 6 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Compare “in”, “out” and “all” degree counts for <strong>directed</strong> and <strong>undirected</strong> graphs. Remember, the defaul is “Directed” graph and defult degree is “out”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a>friends <span class="sc">|&gt;</span> <span class="fu">as_tbl_graph</span>() <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">default_deg=</span><span class="fu">centrality_degree</span>(),</span>
<span id="cb9-2"><a></a>                                    <span class="at">in_deg=</span><span class="fu">centrality_degree</span>(<span class="at">mode=</span><span class="st">"in"</span>),</span>
<span id="cb9-3"><a></a>                                    <span class="at">out_deg=</span><span class="fu">centrality_degree</span>(<span class="at">mode=</span><span class="st">"out"</span>),</span>
<span id="cb9-4"><a></a>                                    <span class="at">all_deg=</span><span class="fu">centrality_degree</span>(<span class="at">mode=</span><span class="st">"all"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 8 nodes and 9 edges
#
# A directed acyclic simple graph with 1 component
#
# Node Data: 8 × 5 (active)
  name    default_deg in_deg out_deg all_deg
  &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 alice             2      0       2       2
2 charles           1      0       1       1
3 david             2      0       2       2
4 bob               2      5       2       7
5 fiona             1      1       1       2
6 gary              1      0       1       1
7 allen             0      2       0       2
8 henry             0      1       0       1
#
# Edge Data: 9 × 2
   from    to
  &lt;int&gt; &lt;int&gt;
1     1     4
2     2     4
3     3     4
# ℹ 6 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a>friends <span class="sc">|&gt;</span> <span class="fu">as_tbl_graph</span>(<span class="at">directed =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">default_deg=</span><span class="fu">centrality_degree</span>(),</span>
<span id="cb11-2"><a></a>                                    <span class="at">in_deg=</span><span class="fu">centrality_degree</span>(<span class="at">mode=</span><span class="st">"in"</span>),</span>
<span id="cb11-3"><a></a>                                    <span class="at">out_deg=</span><span class="fu">centrality_degree</span>(<span class="at">mode=</span><span class="st">"out"</span>),</span>
<span id="cb11-4"><a></a>                                    <span class="at">all_deg=</span><span class="fu">centrality_degree</span>(<span class="at">mode=</span><span class="st">"all"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 8 nodes and 9 edges
#
# An undirected simple graph with 1 component
#
# Node Data: 8 × 5 (active)
  name    default_deg in_deg out_deg all_deg
  &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 alice             2      2       2       2
2 charles           1      1       1       1
3 david             2      2       2       2
4 bob               7      7       7       7
5 fiona             2      2       2       2
6 gary              1      1       1       1
7 allen             2      2       2       2
8 henry             1      1       1       1
#
# Edge Data: 9 × 2
   from    to
  &lt;int&gt; &lt;int&gt;
1     1     4
2     2     4
3     3     4
# ℹ 6 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>We can use <em>dplyr</em> verbs on <em>nodes</em> (or <em>edges</em>) tibbles. Let’s do <em>inner_join</em> and <em>filter</em>ing.</p>
<p>Let’s have a data frame of birth years for people</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a>friends_bday <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">"alice"</span>, <span class="st">"charles"</span>, <span class="st">"david"</span>, <span class="st">"bob"</span>, <span class="st">"fiona"</span>, <span class="st">"gary"</span>, <span class="st">"henry"</span>, <span class="st">"allen"</span>), </span>
<span id="cb13-2"><a></a>       <span class="at">bday =</span> <span class="fu">c</span>(<span class="st">"2001"</span>, <span class="st">"2001"</span>, <span class="st">"2002"</span>, <span class="st">"1999"</span>, <span class="st">"1997"</span>, <span class="st">"2003"</span>, <span class="st">"2000"</span>, <span class="st">"2005"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here are various processes (annotated)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a>result <span class="ot">&lt;-</span> friends_g <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a></a>  <span class="fu">mutate</span>(<span class="at">deg =</span> <span class="fu">centrality_degree</span>(<span class="at">mode=</span><span class="st">"all"</span>)) <span class="sc">|&gt;</span>  <span class="co"># calculate degree for nodes</span></span>
<span id="cb14-3"><a></a>  <span class="fu">filter</span>(deg <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span>                              <span class="co"># remove nodes with deg==1</span></span>
<span id="cb14-4"><a></a>  <span class="fu">inner_join</span>(friends_bday) <span class="sc">|&gt;</span>                     <span class="co"># join bday data with nodes</span></span>
<span id="cb14-5"><a></a>  <span class="fu">arrange</span>(bday) <span class="sc">|&gt;</span>                                <span class="co"># arrange nodes according to bday</span></span>
<span id="cb14-6"><a></a>  <span class="fu">activate</span>(edges) <span class="sc">|&gt;</span>                              <span class="co"># switch to edge tibble</span></span>
<span id="cb14-7"><a></a>  <span class="fu">mutate</span>(<span class="at">betw =</span> <span class="fu">centrality_edge_betweenness</span>()) <span class="sc">|&gt;</span> <span class="co"># calculate betweenness for edges</span></span>
<span id="cb14-8"><a></a>  <span class="fu">activate</span>(nodes)                                 <span class="co"># switch back to nodes tibble</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 5 nodes and 6 edges
#
# A directed acyclic simple graph with 1 component
#
# Node Data: 5 × 3 (active)
  name    deg bday 
  &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;
1 fiona     2 1997 
2 bob       7 1999 
3 alice     2 2001 
4 david     2 2002 
5 allen     2 2005 
#
# Edge Data: 6 × 3
   from    to  betw
  &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
1     3     2     1
2     4     2     2
3     2     5     3
# ℹ 3 more rows</code></pre>
</div>
</div>
</section>
<section id="visualization" class="slide level2">
<h2>Visualization</h2>
<p>Let’s create, process and visualize the toy network below</p>

<img data-src="images/diverse-centrality-measures-v00.png" class="r-stretch"><div class="footer">
<p>source: <a href="https://ultrabpm.wordpress.com/2013/03/25/social-network-analysis-part-two/">Social Network Analysis – part two</a></p>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a>sample_net <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/sample_network.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed=</span><span class="cn">FALSE</span>)</span>
<span id="cb17-3"><a></a></span>
<span id="cb17-4"><a></a>sample_net</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 19 nodes and 32 edges
#
# An undirected simple graph with 1 component
#
# Node Data: 19 × 1 (active)
   name 
   &lt;chr&gt;
 1 a    
 2 b    
 3 c    
 4 d    
 5 e    
 6 f    
 7 g    
 8 h    
 9 i    
10 p    
11 j    
12 n    
13 k    
14 I    
15 m    
16 q    
17 o    
18 s    
19 r    
#
# Edge Data: 32 × 2
   from    to
  &lt;int&gt; &lt;int&gt;
1     1     2
2     1     4
3     1     6
# ℹ 29 more rows</code></pre>
</div>
</div>
<div class="footer">
<p>The file <em>sample_network.xlsx</em> is under <strong>data</strong> folder at rstudio.cloud prject</p>
</div>
</section>
<section id="section" class="slide level2 smaller">
<h2></h2>
<p>Let’s calculate degree (connections) for each node and then arrange according to degree</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a>sample_net <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a></a>  <span class="fu">mutate</span>(<span class="at">deg=</span><span class="fu">centrality_degree</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a></a>  <span class="fu">arrange</span>(<span class="sc">-</span>deg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 19 nodes and 32 edges
#
# An undirected simple graph with 1 component
#
# Node Data: 19 × 2 (active)
   name    deg
   &lt;chr&gt; &lt;dbl&gt;
 1 j         7
 2 d         6
 3 g         5
 4 h         5
 5 b         4
 6 f         4
 7 i         4
 8 a         3
 9 e         3
10 p         3
11 n         3
12 k         3
13 I         3
14 m         3
15 c         2
16 q         2
17 o         2
18 s         1
19 r         1
#
# Edge Data: 32 × 2
   from    to
  &lt;int&gt; &lt;int&gt;
1     5     8
2     2     8
3     6     8
# ℹ 29 more rows</code></pre>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p><em>arrange</em> does not change shape or contents of the network</p>
</div>
</div>
</div>
</section>
<section class="slide level2">

<p>Which node was expected have highest betweenness?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a></a>sample_net <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a></a>  <span class="fu">mutate</span>(<span class="at">betw=</span><span class="fu">centrality_betweenness</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a></a>  <span class="fu">arrange</span>(<span class="sc">-</span>betw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 19 nodes and 32 edges
#
# An undirected simple graph with 1 component
#
# Node Data: 19 × 2 (active)
   name    betw
   &lt;chr&gt;  &lt;dbl&gt;
 1 h     88    
 2 i     81.5  
 3 j     66.5  
 4 m     32    
 5 g     28.8  
 6 q     17    
 7 f     16.3  
 8 d      5.67 
 9 p      5    
10 n      5    
11 c      4    
12 I      1.5  
13 b      0.833
14 k      0.5  
15 a      0.333
16 e      0    
17 o      0    
18 s      0    
19 r      0    
#
# Edge Data: 32 × 2
   from    to
  &lt;int&gt; &lt;int&gt;
1    13    15
2     8    15
3     7    15
# ℹ 29 more rows</code></pre>
</div>
</div>
</section>
<section id="ggraph-package" class="slide level2 smaller">
<h2>{ggraph} package</h2>
<p><em>ggraph</em> is very similar to <em>ggplot</em>. We don’t need to map <em>x</em> and <em>y</em> values, we just have <em>node</em> and <em>edge</em> info. We need to choose geom for the nodes (point, circle, text, etc.) and geom for edges (link, arc, diagonal, elbow, etc.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a></a><span class="fu">library</span>(ggraph)</span>
<span id="cb23-2"><a></a></span>
<span id="cb23-3"><a></a>sample_net <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a></a>  <span class="fu">ggraph</span>() <span class="sc">+</span></span>
<span id="cb23-5"><a></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb23-6"><a></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ders07_files/figure-revealjs/unnamed-chunk-13-1.png" width="1056" class="r-stretch"></section>
<section id="labels-as-layer" class="slide level2">
<h2>Labels as layer</h2>
<p>Let’s add node labels with <em>geom_node_label</em>. This geom need mapping of <strong>label</strong> to a column, we’ll be using <em>name</em> column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a>sample_net <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a></a>  <span class="fu">ggraph</span>() <span class="sc">+</span></span>
<span id="cb24-3"><a></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb24-4"><a></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span></span>
<span id="cb24-5"><a></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label=</span>name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="ders07_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

<p>We can map graph features (in this case <em>centrality_degree</em>) to node properties. Let’s add <em>repel</em> for labels and use a theme specific for graphs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a></a>sample_net <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a></a>  <span class="fu">ggraph</span>() <span class="sc">+</span></span>
<span id="cb25-3"><a></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span><span class="fu">centrality_degree</span>())) <span class="sc">+</span></span>
<span id="cb25-4"><a></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span></span>
<span id="cb25-5"><a></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label=</span>name),<span class="at">repel =</span> T) <span class="sc">+</span></span>
<span id="cb25-6"><a></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="" class="slide level2 output-location-slide"><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="ders07_files/figure-revealjs/unnamed-chunk-15-1.png" width="1056"></p>
</figure>
</div>
</div>
</div></section><section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a>sample_net <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a></a>  <span class="fu">ggraph</span>() <span class="sc">+</span></span>
<span id="cb26-3"><a></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span><span class="fu">centrality_degree</span>(), </span>
<span id="cb26-4"><a></a>                      <span class="at">color=</span><span class="fu">centrality_betweenness</span>())) <span class="sc">+</span>  </span>
<span id="cb26-5"><a></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span></span>
<span id="cb26-6"><a></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label=</span>name),<span class="at">repel =</span> T) <span class="sc">+</span></span>
<span id="cb26-7"><a></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="" class="slide level2 output-location-slide"><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="ders07_files/figure-revealjs/unnamed-chunk-16-1.png" width="1056"></p>
</figure>
</div>
</div>
</div></section><section id="network-visualization-layouts" class="slide level2">
<h2>Network visualization layouts</h2>

<img data-src="images/graph-layouts.png" class="r-stretch"><div class="footer">
<p>source: <a href="https://kateto.net/network-visualization">Static and dynamic network visualization with R</a>. For more <em>ggraph</em> specific layouts please visit these posts <a href="https://www.data-imaginist.com/2017/ggraph-introduction-layouts/">1</a> <a href="https://www.data-imaginist.com/2019/1-giraffe-2-giraffe-go/">2</a> by <em>ggraph</em> author.</p>
</div>
</section>
<section id="relationship-between-words" class="slide level2">
<h2>Relationship between words</h2>
<p>Last week, we used {tidytext} to process text data. Let’s calculate relationships between words and visualize it as a network.</p>
<p><strong>Bigram</strong> is <em>a pair of consecutive written units such as letters, syllables, or words</em>. In our case we’ll be working on bigram words. Here’s an example bigram word tokenization for the sentence “Quick brown fox jumps over lazy dog.”</p>
<pre><code>Quick brown
      brown fox
            fox jumps
                jumps over
                      over lazy
                           lazy dog</code></pre>
</section>
<section id="packages" class="slide level2">
<h2>Packages</h2>
<p>These are the packages that will be used</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a></a><span class="fu">library</span>(tidytext)</span>
<span id="cb28-2"><a></a><span class="fu">library</span>(janeaustenr)</span>
<span id="cb28-3"><a></a><span class="fu">library</span>(widyr)</span>
<span id="cb28-4"><a></a><span class="fu">library</span>(ggraph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s how bigram words are tokenized</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a></a>austen_bigrams <span class="ot">&lt;-</span> <span class="fu">austen_books</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a></a>  <span class="fu">unnest_tokens</span>(bigram, text, <span class="at">token =</span> <span class="st">"ngrams"</span>, <span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a></a>austen_bigrams</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 675,025 × 2
   book                bigram         
   &lt;fct&gt;               &lt;chr&gt;          
 1 Sense &amp; Sensibility sense and      
 2 Sense &amp; Sensibility and sensibility
 3 Sense &amp; Sensibility &lt;NA&gt;           
 4 Sense &amp; Sensibility by jane        
 5 Sense &amp; Sensibility jane austen    
 6 Sense &amp; Sensibility &lt;NA&gt;           
 7 Sense &amp; Sensibility &lt;NA&gt;           
 8 Sense &amp; Sensibility &lt;NA&gt;           
 9 Sense &amp; Sensibility &lt;NA&gt;           
10 Sense &amp; Sensibility &lt;NA&gt;           
# ℹ 675,015 more rows</code></pre>
</div>
</div>
<p>Let’s check most frequent bigrams</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a></a>austen_bigrams <span class="sc">|&gt;</span> <span class="fu">count</span>(bigram, <span class="at">sort=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 193,210 × 2
   bigram      n
   &lt;chr&gt;   &lt;int&gt;
 1 &lt;NA&gt;    12242
 2 of the   2853
 3 to be    2670
 4 in the   2221
 5 it was   1691
 6 i am     1485
 7 she had  1405
 8 of her   1363
 9 to the   1315
10 she was  1309
# ℹ 193,200 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Removing stop words won’t be a simple <code>anti_join</code> since we have two words in a row. We need to <code>separate</code> them into individual words.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a></a>austen_bigram_clean <span class="ot">&lt;-</span>   austen_bigrams <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a></a>  <span class="fu">separate</span>(bigram, <span class="at">into=</span><span class="fu">c</span>(<span class="st">"word1"</span>,<span class="st">"word2"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb34-3"><a></a>  <span class="fu">anti_join</span>(stop_words, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"word1"</span><span class="ot">=</span><span class="st">"word"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb34-4"><a></a>  <span class="fu">anti_join</span>(stop_words, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"word2"</span><span class="ot">=</span><span class="st">"word"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s count now</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a></a>austen_bigram_clean <span class="sc">|&gt;</span> <span class="fu">count</span>(word1, word2, <span class="at">sort=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  word1   word2         n
  &lt;chr&gt;   &lt;chr&gt;     &lt;int&gt;
1 &lt;NA&gt;    &lt;NA&gt;      12242
2 sir     thomas      300
3 miss    crawford    240
4 captain wentworth   167
5 miss    woodhouse   152
6 lady    russell     136</code></pre>
</div>
</div>
</section>
<section id="network-of-bigrams" class="slide level2">
<h2>Network of bigrams</h2>
<p>In bigram count outout, we have “word1”, “word2” and then frequency of them. This looks like two nodes and edge between them. Let’s convert this data into network</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a></a>austen_bigram_clean <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(word1)) <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a></a>  <span class="fu">count</span>(word1, word2, <span class="at">sort=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb37-4"><a></a>  <span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">20</span>) <span class="sc">|&gt;</span>                    <span class="co"># filtering out infrequent pairs for cleaner result</span></span>
<span id="cb37-5"><a></a>  <span class="fu">as_tbl_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 86 nodes and 70 edges
#
# A directed acyclic simple graph with 18 components
#
# Node Data: 86 × 1 (active)
   name    
   &lt;chr&gt;   
 1 sir     
 2 miss    
 3 captain 
 4 lady    
 5 frank   
 6 colonel 
 7 jane    
 8 thousand
 9 henry   
10 dear    
# ℹ 76 more rows
#
# Edge Data: 70 × 3
   from    to     n
  &lt;int&gt; &lt;int&gt; &lt;int&gt;
1     1    29   300
2     2    30   240
3     3    31   167
# ℹ 67 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Let’s visualize the network</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a></a>austen_bigram_clean <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(word1)) <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a></a>  <span class="fu">count</span>(word1, word2, <span class="at">sort=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-4"><a></a>  <span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">20</span>) <span class="sc">|&gt;</span>                    </span>
<span id="cb39-5"><a></a>  <span class="fu">as_tbl_graph</span>() <span class="sc">|&gt;</span></span>
<span id="cb39-6"><a></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"kk"</span>) <span class="sc">+</span> </span>
<span id="cb39-7"><a></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span> </span>
<span id="cb39-8"><a></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span> </span>
<span id="cb39-9"><a></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label=</span>name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="" class="slide level2 output-location-slide"><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="ders07_files/figure-revealjs/unnamed-chunk-24-1.png" width="1056"></p>
</figure>
</div>
</div>
</div></section><section id="co-occurrence-and-correlation" class="slide level2 smaller">
<h2>Co-occurrence and correlation</h2>
<p>Bigram counts only considers words which are <strong>next to</strong> each other. {widyr} package allows counting pairwise counting of words in a <strong>predefined section/window</strong>. Below is a visual describing {widyr} in action.</p>

<img data-src="images/widyr.jpg" class="r-stretch"><div class="footer">
<p><a href="https://bookdown.org/Maxine/tidy-text-mining/counting-and-correlating-pairs-of-words-with-widyr.html">Image source</a></p>
</div>
</section>
<section class="slide level2">

<p>Let’s count words in 10 line sections (considering single book)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a></a>austen_section_words <span class="ot">&lt;-</span> <span class="fu">austen_books</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a></a>  <span class="fu">filter</span>(book <span class="sc">==</span> <span class="st">"Pride &amp; Prejudice"</span>) <span class="sc">|&gt;</span></span>
<span id="cb40-3"><a></a>  <span class="fu">mutate</span>(<span class="at">section =</span> <span class="fu">row_number</span>() <span class="sc">%/%</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb40-4"><a></a>  <span class="fu">filter</span>(section <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb40-5"><a></a>  <span class="fu">unnest_tokens</span>(word, text) <span class="sc">|&gt;</span></span>
<span id="cb40-6"><a></a>  <span class="fu">anti_join</span>(stop_words)</span>
<span id="cb40-7"><a></a></span>
<span id="cb40-8"><a></a>austen_section_words</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 37,240 × 3
   book              section word        
   &lt;fct&gt;               &lt;dbl&gt; &lt;chr&gt;       
 1 Pride &amp; Prejudice       1 truth       
 2 Pride &amp; Prejudice       1 universally 
 3 Pride &amp; Prejudice       1 acknowledged
 4 Pride &amp; Prejudice       1 single      
 5 Pride &amp; Prejudice       1 possession  
 6 Pride &amp; Prejudice       1 fortune     
 7 Pride &amp; Prejudice       1 wife        
 8 Pride &amp; Prejudice       1 feelings    
 9 Pride &amp; Prejudice       1 views       
10 Pride &amp; Prejudice       1 entering    
# ℹ 37,230 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a></a>austen_section_words <span class="sc">|&gt;</span></span>
<span id="cb42-2"><a></a>  <span class="fu">pairwise_count</span>(word, section, <span class="at">sort =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 796,008 × 3
   item1     item2         n
   &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;
 1 darcy     elizabeth   144
 2 elizabeth darcy       144
 3 miss      elizabeth   110
 4 elizabeth miss        110
 5 elizabeth jane        106
 6 jane      elizabeth   106
 7 miss      darcy        92
 8 darcy     miss         92
 9 elizabeth bingley      91
10 bingley   elizabeth    91
# ℹ 795,998 more rows</code></pre>
</div>
</div>
<p>So, the words “darcy” and “elizabeth” were found in same section (10 lines) 144 times, irrespective of order or distance between them.</p>
</section>
<section class="slide level2">

<p>Again, words are nodes and count is the edge data, let’s convert this into network</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a></a>austen_section_words <span class="sc">|&gt;</span></span>
<span id="cb44-2"><a></a>  <span class="fu">pairwise_count</span>(word, section, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-3"><a></a>  <span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">20</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-4"><a></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed =</span> F) <span class="sc">|&gt;</span> </span>
<span id="cb44-5"><a></a>  <span class="fu">activate</span>(edges) <span class="sc">|&gt;</span> </span>
<span id="cb44-6"><a></a>  <span class="fu">distinct</span>() <span class="sc">|&gt;</span>            <span class="co"># removing duplicate edges</span></span>
<span id="cb44-7"><a></a>  <span class="fu">ggraph</span>() <span class="sc">+</span> </span>
<span id="cb44-8"><a></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span> </span>
<span id="cb44-9"><a></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span> </span>
<span id="cb44-10"><a></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label=</span>name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="" class="slide level2 output-location-slide"><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="ders07_files/figure-revealjs/unnamed-chunk-27-1.png" width="1056"></p>
</figure>
</div>
</div>
</div></section><section id="pairwise-correlation" class="slide level2 smaller">
<h2>Pairwise correlation</h2>
<p>Pairs like “Elizabeth” and “Darcy” are the most common co-occurring words, but that’s not particularly meaningful since <em>they’re also the most common individual words.</em> We may instead want to examine <strong>correlation</strong> among words, which indicates how often they appear together relative to how often they appear separately.</p>
<p>In particular, here we’ll focus on the <a href="https://en.wikipedia.org/wiki/Phi_coefficient">phi coefficient</a>, a common measure for binary correlation. The focus of the phi coefficient is how much more likely it is that either <strong>both</strong> word X and Y appear, or <strong>neither</strong> do, than that one appears without the other.</p>
</section>
<section id="section-1" class="slide level2 smaller">
<h2></h2>
<p>Consider the following table:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th></th>
<th>Has word Y</th>
<th>No word Y</th>
<th>Total</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Has word X</td>
<td><span class="math inline">\(n_{11}\)</span></td>
<td><span class="math inline">\(n_{10}\)</span></td>
<td><span class="math inline">\(n_{1\cdot}\)</span></td>
<td></td>
</tr>
<tr class="even">
<td>No word X</td>
<td><span class="math inline">\(n_{01}\)</span></td>
<td><span class="math inline">\(n_{00}\)</span></td>
<td><span class="math inline">\(n_{0\cdot}\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(n_{\cdot 1}\)</span></td>
<td><span class="math inline">\(n_{\cdot 0}\)</span></td>
<td>n</td>
<td></td>
</tr>
</tbody>
</table>
<p>For example, that <span class="math inline">\(n_{11}\)</span> represents the number of documents where both word X and word Y appear, <span class="math inline">\(n_{00}\)</span> the number where neither appears, and <span class="math inline">\(n_{10}\)</span> and <span class="math inline">\(n_{01}\)</span> the cases where one appears without the other. In terms of this table, the phi coefficient is:</p>
<p><span class="math display">\[\phi=\frac{n_{11}n_{00}-n_{10}n_{01}}{\sqrt{n_{1\cdot}n_{0\cdot}n_{\cdot0}n_{\cdot1}}}\]</span> &gt; The phi coefficient is equivalent to the Pearson correlation, which you may have heard of elsewhere, when it is applied to binary data).</p>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a></a>austen_section_words <span class="sc">|&gt;</span></span>
<span id="cb45-2"><a></a>  <span class="fu">group_by</span>(word) <span class="sc">|&gt;</span></span>
<span id="cb45-3"><a></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">10</span>) <span class="sc">|&gt;</span>   <span class="co"># removing infrequent words for simpler calculations</span></span>
<span id="cb45-4"><a></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb45-5"><a></a>  <span class="fu">pairwise_cor</span>(word, section, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 742,182 × 3
   item1     item2     correlation
   &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;
 1 bourgh    de              0.951
 2 de        bourgh          0.951
 3 pounds    thousand        0.701
 4 thousand  pounds          0.701
 5 william   sir             0.664
 6 sir       william         0.664
 7 catherine lady            0.663
 8 lady      catherine       0.663
 9 forster   colonel         0.622
10 colonel   forster         0.622
# ℹ 742,172 more rows</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<p>Let’s convert this to network and visualize it</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a></a>austen_section_words <span class="sc">|&gt;</span></span>
<span id="cb47-2"><a></a>  <span class="fu">group_by</span>(word) <span class="sc">|&gt;</span></span>
<span id="cb47-3"><a></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">10</span>) <span class="sc">|&gt;</span>   <span class="co"># try lower numbers and see what happens</span></span>
<span id="cb47-4"><a></a>  <span class="fu">pairwise_cor</span>(word, section, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb47-5"><a></a>  <span class="fu">filter</span>(correlation <span class="sc">&gt;</span> <span class="fl">0.25</span>) <span class="sc">|&gt;</span> </span>
<span id="cb47-6"><a></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb47-7"><a></a>  <span class="fu">ggraph</span>(<span class="at">layout=</span><span class="st">"kk"</span>) <span class="sc">+</span> </span>
<span id="cb47-8"><a></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span> </span>
<span id="cb47-9"><a></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span> </span>
<span id="cb47-10"><a></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label=</span>name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="" class="slide level2 output-location-slide"><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="ders07_files/figure-revealjs/unnamed-chunk-29-1.png" width="1056"></p>
</figure>
</div>
</div>
</div></section><section id="legos-of-tidy-verbs" class="slide level2 smaller">
<h2>Legos of tidy verbs</h2>
<p>Consider the following code, since different functions from different packages take in tidy data and output tidy data, we can combine them easily. The packages of each function is annotated at each line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a></a><span class="fu">austen_books</span>() <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a></a>  <span class="fu">filter</span>(book <span class="sc">==</span> <span class="st">"Pride &amp; Prejudice"</span>) <span class="sc">|&gt;</span>       <span class="co"># dplyr</span></span>
<span id="cb48-3"><a></a>  <span class="fu">mutate</span>(<span class="at">section =</span> <span class="fu">row_number</span>() <span class="sc">%/%</span> <span class="dv">10</span>) <span class="sc">|&gt;</span>     <span class="co"># dplyr</span></span>
<span id="cb48-4"><a></a>  <span class="fu">filter</span>(section <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span>                       <span class="co"># dplyr</span></span>
<span id="cb48-5"><a></a>  <span class="fu">unnest_tokens</span>(word, text) <span class="sc">|&gt;</span>                 <span class="co"># tidytext</span></span>
<span id="cb48-6"><a></a>  <span class="fu">anti_join</span>(stop_words) <span class="sc">|&gt;</span>                     <span class="co"># dplyr</span></span>
<span id="cb48-7"><a></a>  <span class="fu">group_by</span>(word) <span class="sc">|&gt;</span>                            <span class="co"># dplyr</span></span>
<span id="cb48-8"><a></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">10</span>) <span class="sc">|&gt;</span>                         <span class="co"># dplyr</span></span>
<span id="cb48-9"><a></a>  <span class="fu">pairwise_cor</span>(word, section, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span>  <span class="co"># widyr</span></span>
<span id="cb48-10"><a></a>  <span class="fu">filter</span>(correlation <span class="sc">&gt;</span> <span class="fl">0.25</span>) <span class="sc">|&gt;</span>                <span class="co"># dplyr</span></span>
<span id="cb48-11"><a></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span>              <span class="co"># tidygraph</span></span>
<span id="cb48-12"><a></a>  <span class="fu">mutate</span>(<span class="at">deg=</span><span class="fu">centrality_degree</span>()) <span class="sc">|&gt;</span>           <span class="co"># dplyr / tidygraph</span></span>
<span id="cb48-13"><a></a>  <span class="fu">ggraph</span>(<span class="at">layout=</span><span class="st">"kk"</span>) <span class="sc">+</span>                        <span class="co"># ggraph</span></span>
<span id="cb48-14"><a></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span>                          <span class="co"># ggraph</span></span>
<span id="cb48-15"><a></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span>                           <span class="co"># ggraph</span></span>
<span id="cb48-16"><a></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label=</span>name))             <span class="co"># ggraph</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>